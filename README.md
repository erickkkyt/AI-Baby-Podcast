# AI Baby Podcast: ä¸ªæ€§åŒ–æ’­å®¢è§†é¢‘ç”Ÿæˆå™¨

AI Baby Podcast æ˜¯ä¸€ä¸ª Next.js åº”ç”¨ç¨‹åºï¼Œå…è®¸ç”¨æˆ·ç”Ÿæˆä»¥ AI ç”Ÿæˆçš„å©´å„¿å¤´åƒä¸ºç‰¹è‰²çš„ä¸ªæ€§åŒ–æ’­å®¢é£æ ¼è§†é¢‘ã€‚ç”¨æˆ·å¯ä»¥æŒ‡å®šå©´å„¿çš„ç§æ—ã€å‘å‹å’Œæ’­å®¢ä¸»é¢˜ç­‰å‚æ•°ã€‚æ­¤è¾“å…¥ä¼šè§¦å‘ n8n å·¥ä½œæµç¨‹æ¥åˆ›å»ºè§†é¢‘ã€‚å®Œæˆåï¼Œn8n ä¼šå›è°ƒ Next.js åç«¯ APIï¼Œè¯¥ API ä¼šä½¿ç”¨é¡¹ç›®çŠ¶æ€å’Œè§†é¢‘ URL æ›´æ–° Supabase æ•°æ®åº“ã€‚ç„¶åç”¨æˆ·å°±å¯ä»¥è®¿é—®ç”Ÿæˆçš„è§†é¢‘äº†ã€‚

## âœ¨æ ¸å¿ƒåŠŸèƒ½

*   **ç”¨æˆ·ä»ªè¡¨ç›˜:** ä¾›ç”¨æˆ·è¾“å…¥æ’­å®¢å‚æ•°ï¼ˆå©´å„¿å¤–è§‚ã€ä¸»é¢˜ï¼‰çš„ç•Œé¢ã€‚
*   **n8n å·¥ä½œæµç¨‹é›†æˆ:** å°†å‚æ•°æäº¤ç»™ n8n å·¥ä½œæµç¨‹ä»¥ç”Ÿæˆè§†é¢‘ã€‚
*   **Supabase åç«¯:** ä½¿ç”¨ Supabase è¿›è¡Œç”¨æˆ·èº«ä»½éªŒè¯ã€æ•°æ®åº“å­˜å‚¨ï¼ˆé¡¹ç›®ã€ç”¨æˆ·ç§¯åˆ†ï¼‰å’Œå®æ—¶æ›´æ–°ã€‚
*   **è§†é¢‘æ’­æ”¾å’Œä¸‹è½½:** ç”¨æˆ·å¯ä»¥æŸ¥çœ‹å’Œä¸‹è½½ä»–ä»¬ç”Ÿæˆçš„è§†é¢‘ã€‚
*   **ç§¯åˆ†ç³»ç»Ÿ:** æ¯æ¬¡è§†é¢‘ç”Ÿæˆè¯·æ±‚éƒ½ä¼šæ‰£é™¤ç”¨æˆ·ç§¯åˆ†ã€‚
*   **n8n Webhook:** ç”¨äºä» n8n å·¥ä½œæµç¨‹æ¥æ”¶çŠ¶æ€æ›´æ–°çš„ä¸“ç”¨ API è·¯ç”±ã€‚

## ğŸ› ï¸æŠ€æœ¯æ ˆ

*   **å‰ç«¯:** [Next.js] (App Router), [React], [Tailwind CSS], [Shadcn UI] (éƒ¨åˆ†ä½¿ç”¨ï¼ŒæŸäº›ç»„ä»¶ä½¿ç”¨åŸºç¡€ HTML/Tailwind)
*   **åç«¯:** [Next.js] API è·¯ç”±
*   **æ•°æ®åº“ä¸è®¤è¯:** [Supabase] (PostgreSQL, Supabase Auth, Supabase Storage - å°½ç®¡ç°åœ¨è§†é¢‘ URL æ˜¯ç›´æ¥å­˜å‚¨çš„)
*   **å·¥ä½œæµç¨‹è‡ªåŠ¨åŒ–:** [n8n.io]
*   **è¯­è¨€:** [TypeScript]
*   **æ ·å¼:** [Tailwind CSS]
*   **UI ç»„ä»¶:** ä¸»è¦ä½¿ç”¨ Tailwind çš„è‡ªå®šä¹‰ç»„ä»¶ï¼Œéƒ¨åˆ†ä½¿ç”¨ Radix UI åŸè¯­ã€‚
*   **çŠ¶æ€ç®¡ç† (URL):** `nuqs` ç”¨äº URL æœç´¢å‚æ•°çŠ¶æ€ç®¡ç†ã€‚

## ğŸ“‚é¡¹ç›®ç»“æ„

ä»¥ä¸‹æ˜¯é¡¹ç›®ç›®å½•ç»“æ„çš„ç®€åŒ–æ¦‚è¿°ï¼š

```
AI-Baby-Podcast/
â”œâ”€â”€ .next/                      # Next.js æ„å»ºè¾“å‡º
â”œâ”€â”€ .vscode/                    # VSCode è®¾ç½®
â”œâ”€â”€ node_modules/               # é¡¹ç›®ä¾èµ–
â”œâ”€â”€ public/                     # é™æ€èµ„æº (å›¾ç‰‡, å›¾æ ‡)
â”‚   â”œâ”€â”€ next.svg
â”‚   â””â”€â”€ vercel.svg
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/                    # Next.js App Router (ä¸»è¦åº”ç”¨ç¨‹åºé€»è¾‘)
â”‚   â”‚   â”œâ”€â”€ (pages)/            # ä¸»è¦é¡µé¢çš„è·¯ç”±ç»„
â”‚   â”‚   â”‚   â”œâ”€â”€ dashboard/      # ç”¨æˆ·ä»ªè¡¨ç›˜éƒ¨åˆ†
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ projects/   # æ˜¾ç¤ºç”¨æˆ·ç”Ÿæˆè§†é¢‘çš„é¡µé¢
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx    # ä¸»è¦ä»ªè¡¨ç›˜åˆ›å»ºé¡µé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ login/          # ç™»å½•é¡µé¢
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ actions.ts  # ç™»å½•/æ³¨å†Œçš„æœåŠ¡å™¨æ“ä½œ
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ pricing/        # å®šä»·é¡µé¢
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx        # ç€é™†é¡µ (é¦–é¡µ)
â”‚   â”‚   â”œâ”€â”€ api/                # API è·¯ç”±
â”‚   â”‚   â”‚   â”œâ”€â”€ auth/           # è®¤è¯ç›¸å…³çš„ API ç«¯ç‚¹ (ä¾‹å¦‚å›è°ƒ)
â”‚   â”‚   â”‚   â”œâ”€â”€ submit-podcast-idea/ # æäº¤æ’­å®¢æƒ³æ³•
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ route.ts    # API ç«¯ç‚¹ï¼Œç”¨äºæ¥æ”¶æ’­å®¢æƒ³æ³•ã€ä¸ Supabase (RPC) äº¤äº’å¹¶è§¦å‘ n8n
â”‚   â”‚   â”‚   â””â”€â”€ webhook/
â”‚   â”‚   â”‚       â””â”€â”€ n8n-video-ready/ # n8n è§†é¢‘å‡†å¤‡å°±ç»ª
â”‚   â”‚   â”‚           â””â”€â”€ route.ts # API ç«¯ç‚¹ï¼Œä¾› n8n å›è°ƒè§†é¢‘çŠ¶æ€å’Œ URL
â”‚   â”‚   â”œâ”€â”€ layout.tsx          # åº”ç”¨ç¨‹åºçš„æ ¹å¸ƒå±€
â”‚   â”‚   â”œâ”€â”€ globals.css         # å…¨å±€æ ·å¼
â”‚   â”‚   â””â”€â”€ error.tsx           # è‡ªå®šä¹‰å…¨å±€é”™è¯¯é¡µé¢
â”‚   â”œâ”€â”€ components/             # å¯å¤ç”¨ React ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ auth/               # è®¤è¯ç›¸å…³çš„ UI ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ modals/             # æ¨¡æ€å¯¹è¯æ¡†ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ ConfirmationModal.tsx
â”‚   â”‚   â”‚   â””â”€â”€ InsufficientCreditsModal.tsx # ç§¯åˆ†ä¸è¶³æ¨¡æ€æ¡†
â”‚   â”‚   â”œâ”€â”€ DashboardClient.tsx # ä¸»ä»ªè¡¨ç›˜ UI å’Œé€»è¾‘çš„å®¢æˆ·ç«¯ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ DashboardSiderbar.tsx # ä»ªè¡¨ç›˜å¯¼èˆªå’Œç§¯åˆ†æ˜¾ç¤ºçš„ä¾§è¾¹æ ç»„ä»¶
â”‚   â”‚   â””â”€â”€ ProjectsClient.tsx  # æ˜¾ç¤ºç”¨æˆ·é¡¹ç›® (è§†é¢‘) çš„å®¢æˆ·ç«¯ç»„ä»¶
â”‚   â”œâ”€â”€ contexts/               # React contexts (å¦‚æœ‰)
â”‚   â”œâ”€â”€ hooks/                  # è‡ªå®šä¹‰ React hooks
â”‚   â”œâ”€â”€ lib/                    # å·¥å…·å‡½æ•°å’Œåº“ (ä¾‹å¦‚ Supabase å®¢æˆ·ç«¯è®¾ç½®)
â”‚   â”œâ”€â”€ types/                  # TypeScript ç±»å‹å®šä¹‰
â”‚   â”‚   â””â”€â”€ project.ts
â”‚   â”œâ”€â”€ utils/                  # å·¥å…·å‡½æ•°
â”‚   â”‚   â””â”€â”€ supabase/           # Supabase å®¢æˆ·ç«¯å’Œä¸­é—´ä»¶é…ç½®
â”‚   â”‚       â”œâ”€â”€ client.ts
â”‚   â”‚       â”œâ”€â”€ middleware.ts
â”‚   â”‚       â””â”€â”€ server.ts
â”‚   â””â”€â”€ middleware.ts           # Next.js ä¸­é—´ä»¶ï¼Œç”¨äºè®¤è¯å’Œè¯·æ±‚å¤„ç†
â”œâ”€â”€ .env.local.example          # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â”œâ”€â”€ .gitignore
â”œâ”€â”€ eslint.config.mjs           # ESLint é…ç½®
â”œâ”€â”€ next.config.mjs             # Next.js é…ç½®
â”œâ”€â”€ package.json
â”œâ”€â”€ postcss.config.mjs          # PostCSS é…ç½®
â”œâ”€â”€ README.md                   # æœ¬æ–‡ä»¶
â”œâ”€â”€ tsconfig.json               # TypeScript é…ç½®
â””â”€â”€ æ•°æ®åº“.md                   # æ•°æ®åº“ç»“æ„å’Œç¬”è®° (ä¸­æ–‡)
```

### å…³é”®æ–‡ä»¶å’Œç›®å½•è¯´æ˜ï¼š

*   **`src/app/`**: ä½¿ç”¨ App Router çš„ Next.js åº”ç”¨ç¨‹åºçš„æ ¸å¿ƒã€‚
    *   **`src/app/api/submit-podcast-idea/route.ts`**: å¤„ç†æ¥è‡ªä»ªè¡¨ç›˜çš„ç”¨æˆ·æäº¤ã€‚å®ƒä¼šéªŒè¯è¾“å…¥ï¼Œè°ƒç”¨ Supabase RPC å‡½æ•° (`deduct_credits_and_create_project`) æ¥ç®¡ç†ç§¯åˆ†å¹¶åˆ›å»ºé¡¹ç›®è®°å½•ï¼Œç„¶åè§¦å‘ n8n å·¥ä½œæµç¨‹ã€‚
    *   **`src/app/api/webhook/n8n-video-ready/route.ts`**: è¿™æ˜¯ n8n å·¥ä½œæµç¨‹çš„å›è°ƒç«¯ç‚¹ã€‚å®ƒä» n8n æ¥æ”¶ `jobId`ã€è§†é¢‘ `status` å’Œ `videoUrl`ã€‚å®ƒä¼šéªŒè¯è¯·æ±‚å¹¶æ›´æ–° Supabase `projects` è¡¨ä¸­ç›¸åº”çš„é¡¹ç›®ã€‚
    *   **`src/app/dashboard/page.tsx`**: ä¸»ä»ªè¡¨ç›˜é¡µé¢çš„æœåŠ¡å™¨ç»„ä»¶ã€‚è·å–ç”¨æˆ·ç§¯åˆ†ç­‰åˆå§‹æ•°æ®ã€‚
    *   **`src/app/dashboard/projects/page.tsx`**: "æˆ‘çš„é¡¹ç›®"é¡µé¢çš„æœåŠ¡å™¨ç»„ä»¶ï¼Œè·å–ç”¨æˆ·çš„é¡¹ç›®ã€‚
    *   **`src/app/login/actions.ts`**: åŒ…å«ç”¨äºå¤„ç†ç”¨æˆ·ç™»å½•å’Œæ³¨å†Œçš„æœåŠ¡å™¨æ“ä½œã€‚
*   **`src/components/`**: åŒ…å«å¯å¤ç”¨çš„ UI ç»„ä»¶ã€‚
    *   **`DashboardClient.tsx`**: ä»ªè¡¨ç›˜çš„ä¸»è¦å®¢æˆ·ç«¯ç»„ä»¶ï¼Œå¤„ç†ç”¨æˆ·è¾“å…¥ã€è¡¨å•æäº¤å’Œæ˜¾ç¤ºçŠ¶æ€æ¶ˆæ¯ã€‚
    *   **`DashboardSiderbar.tsx`**: æä¾›ä»ªè¡¨ç›˜å¯¼èˆªï¼Œç°åœ¨è¿˜æ˜¾ç¤ºç”¨æˆ·çš„å½“å‰ç§¯åˆ†ã€‚
    *   **`ProjectsClient.tsx`**: è´Ÿè´£å‘ˆç°ç”¨æˆ·é¡¹ç›®åˆ—è¡¨çš„å®¢æˆ·ç«¯ç»„ä»¶ï¼ŒåŒ…æ‹¬è§†é¢‘æ’­æ”¾å™¨å’Œä¸‹è½½é“¾æ¥ã€‚
    *   **`modals/InsufficientCreditsModal.tsx`**: å½“ç”¨æˆ·å°è¯•åˆ›å»ºé¡¹ç›®ä½†ç§¯åˆ†ä¸è¶³æ—¶æ˜¾ç¤ºçš„æ¨¡æ€æ¡†ã€‚
*   **`src/utils/supabase/`**: åŒ…å«ç”¨äºæœåŠ¡å™¨ç«¯ã€å®¢æˆ·ç«¯å’Œä¸­é—´ä»¶çš„ Supabase å®¢æˆ·ç«¯é…ç½®ï¼Œå·²é€‚é… `@supabase/ssr`ã€‚
*   **`src/middleware.ts`**: Next.js ä¸­é—´ä»¶ï¼Œä¸»è¦ç”¨äº Supabase èº«ä»½éªŒè¯ï¼Œç¡®ä¿ç”¨æˆ·ä¼šè¯åœ¨è¯·æ±‚ä¹‹é—´å¾—åˆ°æ­£ç¡®å¤„ç†ï¼Œå¹¶æ›´æ–° Supabase å®¢æˆ·ç«¯å®ä¾‹ã€‚
*   **`æ•°æ®åº“.md`**: åŒ…å«æœ‰å…³ Supabase æ•°æ®åº“ç»“æ„ã€è¡¨ï¼ˆ`projects`ã€`user_profiles`ï¼‰ã€RLS ç­–ç•¥ä»¥åŠ RPC å‡½æ•°ï¼ˆå¦‚ `deduct_credits_and_create_project` å’Œ `handle_new_user` è§¦å‘å™¨ï¼‰çš„è¯¦ç»†ä¿¡æ¯ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹ (ç®€åŒ–ç‰ˆ)

### å…ˆå†³æ¡ä»¶

*   Node.js (æ¨è v18+)
*   npm æˆ– pnpm æˆ– yarn
*   Supabase è´¦æˆ·å’Œé¡¹ç›®
*   n8n å®ä¾‹ (äº‘ç«¯æˆ–è‡ªæ‰˜ç®¡)ï¼Œå¸¦æœ‰ webhook è§¦å‘å™¨å’Œ HTTP è¯·æ±‚èŠ‚ç‚¹ã€‚

### è®¾ç½®

1.  **å…‹éš†ä»“åº“ã€‚**
2.  **å®‰è£…ä¾èµ–:** `npm install` (æˆ– `pnpm install`, `yarn install`)ã€‚
3.  **ç¯å¢ƒå˜é‡:**
    *   åœ¨æ ¹ç›®å½•åˆ›å»ºä¸€ä¸ª `.env.local` æ–‡ä»¶ã€‚
    *   æ·»åŠ ä½ çš„ Supabase URL å’Œ Anon Key:
        ```env
        NEXT_PUBLIC_SUPABASE_URL=your_supabase_url
        NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
        NEXT_PUBLIC_N8N_WEBHOOK_URL=your_n8n_trigger_webhook_url_for_submit_idea
        ```
    *   åœ¨ä½ çš„ Supabase é¡¹ç›®è®¾ç½®æˆ–éƒ¨ç½²ç¯å¢ƒ (ä¾‹å¦‚ Vercel) ä¸­å°† Supabase Service Role Key å’Œ N8N API Key (ç”¨äº webhook å®‰å…¨) é…ç½®ä¸ºæœºå¯†ä¿¡æ¯ã€‚API è·¯ç”±ä¼šä½¿ç”¨è¿™äº›å¯†é’¥ã€‚
        *   `SUPABASE_SERVICE_ROLE_KEY`
        *   `N8N_API_KEY` (è¿™æ˜¯ä½ çš„ Next.js åº”ç”¨å’Œ n8n ä¹‹é—´çš„å…±äº«å¯†é’¥ï¼Œç”¨äºä¿æŠ¤ `/n8n-video-ready` webhook)

4.  **Supabase è®¾ç½®:**
    *   æœ‰å…³è¡¨ç»“æ„ (`projects`, `user_profiles`)ã€RPC å‡½æ•° (`deduct_credits_and_create_project`, `handle_new_user`) å’Œ RLS ç­–ç•¥ï¼Œè¯·å‚é˜… `æ•°æ®åº“.md`ã€‚ç¡®ä¿åœ¨ä½ çš„ Supabase é¡¹ç›®ä¸­è®¾ç½®å¥½è¿™äº›å†…å®¹ã€‚
    *   `auth.users` ä¸Šçš„ `handle_new_user` è§¦å‘å™¨ä¼šè‡ªåŠ¨ä¸ºæ–°æ³¨å†Œç”¨æˆ·å¡«å…… `user_profiles` å¹¶æä¾›åˆå§‹ç§¯åˆ†ã€‚

5.  **n8n å·¥ä½œæµç¨‹è®¾ç½®:**
    *   **è§¦å‘å™¨:** Webhook èŠ‚ç‚¹ï¼Œæ¥æ”¶æ¥è‡ª `/api/submit-podcast-idea` çš„ POST è¯·æ±‚ã€‚å®ƒéœ€è¦ `jobId`ã€`ethnicity`ã€`hair`ã€`topic`ã€‚
    *   **è§†é¢‘ç”Ÿæˆé€»è¾‘:** ä½ çš„æ ¸å¿ƒè§†é¢‘ç”Ÿæˆæ­¥éª¤ (ä¾‹å¦‚ä½¿ç”¨ AI è§†é¢‘ API)ã€‚
    *   **å›è°ƒ:** HTTP è¯·æ±‚èŠ‚ç‚¹ï¼Œå‘ä½ çš„ Next.js åº”ç”¨çš„ `/api/webhook/n8n-video-ready` å‘é€ POST è¯·æ±‚ã€‚
        *   **æ–¹æ³•:** POST
        *   **æ­£æ–‡ (JSON):** `{ "jobId": "...", "videoUrl": "...", "status": "completed" | "failed", "errorMessage": "..." }`
        *   **è®¤è¯:** è¯·æ±‚å¤´ `Authorization: Bearer YOUR_N8N_API_KEY` (æˆ– `X-Webhook-Secret: YOUR_N8N_API_KEY`ï¼Œå…·ä½“å–å†³äº Next.js API è·¯ç”±ä¸­çš„é…ç½®)ã€‚

### è¿è¡Œé¡¹ç›®

1.  **æœ¬åœ°å¼€å‘:**
    ```bash
    npm run dev
    ```
    åº”ç”¨ç¨‹åºå°†åœ¨ `http://localhost:3000` ä¸Šå¯ç”¨ã€‚
2.  **éƒ¨ç½²:**
    *   éƒ¨ç½²åˆ°åƒ Vercel æˆ– Netlify è¿™æ ·çš„å¹³å°ã€‚
    *   ç¡®ä¿åœ¨éƒ¨ç½²ç¯å¢ƒä¸­é…ç½®äº†æ‰€æœ‰å¿…è¦çš„ç¯å¢ƒå˜é‡ (Supabaseå¯†é’¥, n8n URL/å¯†é’¥)ã€‚

## ğŸ”„è¿‘æœŸæ›´æ–°å’Œå¼€å‘æ—¥å¿—

*   **ç§¯åˆ†ç³»ç»Ÿå·²å®ç°:**
    *   åœ¨ Supabase ä¸­åˆ›å»ºäº† `user_profiles` è¡¨æ¥å­˜å‚¨ç”¨æˆ·ç§¯åˆ†ã€‚
    *   `handle_new_user` è§¦å‘å™¨ä¸ºæ–°ç”¨æˆ·æ·»åŠ åˆå§‹ç§¯åˆ† (ä¾‹å¦‚ 100)ã€‚
    *   Supabase ä¸­çš„ `deduct_credits_and_create_project` RPC å‡½æ•°:
        *   æ£€æŸ¥æ˜¯å¦æœ‰è¶³å¤Ÿçš„ç§¯åˆ†ã€‚
        *   æ‰£é™¤ç§¯åˆ†ã€‚
        *   åœ¨ `projects` è¡¨ä¸­åˆ›å»ºé¡¹ç›®è®°å½•ã€‚
        *   æ‰€æœ‰æ“ä½œéƒ½åœ¨ä¸€ä¸ªæ•°æ®åº“äº‹åŠ¡ä¸­å®Œæˆã€‚
    *   `/api/submit-podcast-idea` è·¯ç”±ç°åœ¨è°ƒç”¨æ­¤ RPCã€‚
    *   å‰ç«¯æ›´æ–°:
        *   `DashboardSiderbar.tsx` æ˜¾ç¤ºå½“å‰ç”¨æˆ·ç§¯åˆ†ã€‚
        *   `DashboardClient.tsx` åœ¨æäº¤å‰æ£€æŸ¥ç§¯åˆ†ã€‚
        *   å¦‚æœç§¯åˆ†è¿‡ä½ï¼Œåˆ™æ˜¾ç¤º `InsufficientCreditsModal.tsx`ï¼Œæç¤ºæ£€æŸ¥å®šä»·ã€‚
*   **API è·¯ç”±å·²æ›´æ–°ä»¥é€‚é… `@supabase/ssr`:**
    *   æ›´æ–°äº† `src/utils/supabase/server.ts`ã€`client.ts`ã€`middleware.ts`ã€‚
    *   API è·¯ç”±ç°åœ¨å¯ä»¥æ­£ç¡®åœ° `await createClient()` ä» `@/utils/supabase/server` è·å–å®¢æˆ·ç«¯ã€‚
*   **é”™è¯¯å¤„ç†æ”¹è¿›:**
    *   `catch` å—ä¸­æ›´å¥½çš„é”™è¯¯ç±»å‹å¤„ç† (ä½¿ç”¨ `unknown` å¹¶å®‰å…¨è®¿é—®)ã€‚
    *   API è·¯ç”±è¿”å›æ›´å…·ä½“çš„é”™è¯¯æ¶ˆæ¯ (ä¾‹å¦‚ï¼Œç§¯åˆ†ä¸è¶³)ã€‚
    *   å…¨å±€é”™è¯¯é¡µé¢ `src/app/error.tsx` çš„æ–‡æœ¬å·²ç¿»è¯‘æˆè‹±æ–‡ã€‚
*   **"æˆ‘çš„é¡¹ç›®"é¡µé¢ (`src/app/dashboard/projects`):**
    *   æ˜¾ç¤ºç”¨æˆ·ç”Ÿæˆçš„è§†é¢‘ï¼ŒåŒ…æ‹¬çŠ¶æ€ã€æ’­æ”¾å™¨å’Œä¸‹è½½é“¾æ¥ã€‚
    *   ä½¿ç”¨åŸºç¡€ HTML/Tailwind ä½œä¸º UI å…ƒç´ ï¼Œè€Œä¸æ˜¯å®Œæ•´çš„ Shadcn UI ç»„ä»¶ï¼Œä»¥é¿å…ä¾èµ–é—®é¢˜ã€‚
    *   ä½¿ç”¨ `date-fns` æ ¼å¼åŒ–æ—¥æœŸã€‚
*   **n8n Webhook å®‰å…¨æ€§:** `/api/webhook/n8n-video-ready` ä¼šéªŒè¯å…±äº«å¯†é’¥ (`N8N_API_KEY`)ã€‚
*   **è§†é¢‘ URL å­˜å‚¨:** ç›´æ¥åœ¨ `projects` è¡¨ä¸­å­˜å‚¨æ¥è‡ª n8n çš„ `videoUrl`ï¼Œè€Œä¸æ˜¯é‡æ–°ä¸Šä¼ ã€‚
*   **ä»ªè¡¨ç›˜ UI æ¸…ç†:** ä»ä¸» `DashboardClient.tsx` ä¸­ç§»é™¤äº†"æˆ‘çš„é¡¹ç›®"é¢„è§ˆéƒ¨åˆ†ï¼Œä»¥ç®€åŒ–åˆ›å»ºé¡µé¢ã€‚
*   **RLS ç­–ç•¥è°ƒè¯•:** è§£å†³äº†ä¸ä» RPC å‡½æ•°å†…éƒ¨å‘ `projects` æ’å…¥æ•°æ®å’Œæ›´æ–° `user_profiles`ç›¸å…³çš„å‡ ä¸ª RLS é—®é¢˜ã€‚å…³é”®æ˜¯ç¡®ä¿ `authenticated` è§’è‰²ï¼ˆç”¨æˆ·ä¼šè¯åœ¨è°ƒç”¨ RPC æ—¶ä½¿ç”¨çš„è§’è‰²ï¼‰å…·æœ‰å¿…è¦çš„æƒé™ï¼Œæˆ–è€… RPC å‡½æ•°æœ¬èº«ä»¥æå‡çš„æƒé™è¿è¡Œï¼ˆå¦‚æœä½¿ç”¨ `SECURITY DEFINER` å®šä¹‰å¹¶ç”±è¶…çº§ç”¨æˆ·æ‹¥æœ‰ï¼‰ï¼ˆå°½ç®¡æ­¤å¤„ä½¿ç”¨äº†å¯¹ `authenticated` çš„ç›´æ¥ RLS æˆæƒï¼‰ã€‚
*   **ç±»å‹å®šä¹‰ä¿®å¤:** è§£å†³äº† Vercel éƒ¨ç½²ä¸­ `src/types/project.ts` ä¸æ˜¯æ¨¡å—çš„é”™è¯¯ï¼Œé€šè¿‡åœ¨è¯¥æ–‡ä»¶ä¸­å®šä¹‰å¹¶å¯¼å‡º `Project` æ¥å£ã€‚
*   **æ¨¡æ€æ¡†å±æ€§ä¿®å¤:** ä¿®å¤äº† `DashboardClient.tsx` ä¸­ `ConfirmationModal` ç»„ä»¶çš„ `onClose` å±æ€§é”™è¯¯ï¼Œå°†å…¶æ›´æ­£ä¸º `onCancel`ï¼Œä»¥è§£å†³ Vercel æ„å»ºé”™è¯¯ã€‚
*   **æ¨¡æ€æ¡†æ–‡æœ¬å±æ€§ä¿®å¤:** ä¿®å¤äº† `DashboardClient.tsx` ä¸­ `ConfirmationModal` ç»„ä»¶çš„ `confirmButtonText` å’Œ `cancelButtonText` å±æ€§é”™è¯¯ï¼Œå°†å…¶æ›´æ­£ä¸º `confirmText` å’Œ `cancelText`ï¼Œä»¥è§£å†³ Vercel æ„å»ºé”™è¯¯ã€‚
*   **ESLint é”™è¯¯ä¿®å¤:** ä¿®å¤äº† `src/app/error.tsx` ä¸­çš„ `react/no-unescaped-entities` ESLint é”™è¯¯ï¼Œå°†æœªè½¬ä¹‰çš„å•å¼•å·æ›¿æ¢ä¸º HTML å®ä½“ï¼Œä»¥è§£å†³ Vercel æ„å»ºé”™è¯¯ã€‚
*   **API é”™è¯¯å“åº”æ”¹è¿›:** ä¿®æ”¹äº† `/api/submit-podcast-idea` è·¯ç”±ï¼Œä»¥ä¾¿åœ¨æ•°æ®åº“ RPC è°ƒç”¨å¤±è´¥æ—¶ï¼Œèƒ½æ›´æ¸…æ™°åœ°å°†é”™è¯¯è¯¦æƒ…ä½œä¸ºå­—ç¬¦ä¸²ä¼ é€’ç»™å®¢æˆ·ç«¯ï¼Œé¿å…äº†å‰ç«¯æ˜¾ç¤º `[object Object]` çš„é—®é¢˜ã€‚
*   **RPC å‚æ•°ä¿®å¤:** æ ¹æ®æ•°æ®åº“é”™è¯¯æ—¥å¿— (PGRST202)ï¼Œä¿®æ­£äº† `/api/submit-podcast-idea` è·¯ç”±ä¸­è°ƒç”¨ `deduct_credits_and_create_project` RPC å‡½æ•°æ—¶ä¼ é€’çš„å‚æ•°ï¼Œç¡®ä¿ä¸æ•°æ®åº“å‡½æ•°ç­¾åä¸€è‡´ (æ·»åŠ  `p_credits_to_deduct`ï¼Œç§»é™¤ `p_user_id`)ã€‚
*   **RPC å“åº”å¤„ç†ä¿®å¤:** è°ƒæ•´äº† `/api/submit-podcast-idea` è·¯ç”±å¯¹ `deduct_credits_and_create_project` RPC å‡½æ•°æˆåŠŸå“åº”çš„å¤„ç†é€»è¾‘ï¼Œä»¥é€‚åº” RPC ç›´æ¥è¿”å›æ‰å¹³é¡¹ç›®å¯¹è±¡è€ŒéåµŒå¥—å¯¹è±¡çš„æƒ…å†µã€‚åŒæ—¶ç¡®ä¿äº†é”™è¯¯è·¯å¾„ä¸‹çš„ `details` å­—æ®µä¸ºå­—ç¬¦ä¸²ï¼Œé¿å…å‰ç«¯æ˜¾ç¤º `[object Object]`ã€‚
*   **UI æ–‡æœ¬æ›´æ–°:** æ›´æ–°äº† Projects é¡µé¢çš„å¤„ç†ä¸­å¡ç‰‡å’Œ Dashboard åˆ›å»ºæˆåŠŸåçš„æç¤ºä¿¡æ¯ï¼Œå¢åŠ äº†é¢„è®¡ç­‰å¾…æ—¶é—´ (çº¦3åˆ†é’Ÿ) çš„æè¿°ï¼Œä»¥æ”¹å–„ç”¨æˆ·ä½“éªŒã€‚
*   **ESLint é”™è¯¯ä¿®å¤ (Privacy Policy):** ä¿®å¤äº† `src/app/privacy-policy/page.tsx` ä¸­çš„ `react/no-unescaped-entities` ESLint é”™è¯¯ï¼Œå°† JSX ä¸­æœªè½¬ä¹‰çš„å¼•å·å’Œæ’‡å·æ›¿æ¢ä¸ºç›¸åº”çš„ HTML å®ä½“ï¼Œä»¥è§£å†³ Vercel æ„å»ºé”™è¯¯ã€‚
*   **ESLint é”™è¯¯ä¿®å¤ (Terms of Service):** ä¿®å¤äº† `src/app/terms-of-service/page.tsx` ä¸­çš„ `react/no-unescaped-entities` ESLint é”™è¯¯ï¼Œå°† JSX ä¸­æœªè½¬ä¹‰çš„å¼•å·å’Œæ’‡å·æ›¿æ¢ä¸ºç›¸åº”çš„ HTML å®ä½“ï¼Œä»¥è§£å†³ Vercel æ„å»ºé”™è¯¯ã€‚

## âš ï¸å·²çŸ¥é—®é¢˜å’Œæ³¨æ„äº‹é¡¹

*   **è€ç”¨æˆ·ç§¯åˆ†:** åœ¨ `handle_new_user` è§¦å‘å™¨å’Œ `user_profiles` è¡¨åˆ›å»ºä¹‹å‰åˆ›å»ºçš„ç°æœ‰ç”¨æˆ·å¯èƒ½æ²¡æœ‰ç§¯åˆ†æ¡ç›®ã€‚å¯èƒ½éœ€è¦æ‰‹åŠ¨å›å¡«è„šæœ¬æˆ–ä¸€ç§æœºåˆ¶ï¼Œåœ¨ä»–ä»¬é¦–æ¬¡ç™»å½•/æ“ä½œæ—¶åˆ›å»ºå…¶ä¸ªäººèµ„æ–™ã€‚
*   **n8n å·¥ä½œæµç¨‹å¤æ‚æ€§:** n8n ä¸­çš„å®é™…è§†é¢‘ç”Ÿæˆæ˜¯ä¸€ä¸ªå ä½ç¬¦ï¼›çœŸæ­£çš„å®ç°å°†æ¶‰åŠä¸ AI è§†é¢‘ API (ä¾‹å¦‚ D-IDã€Synthesiaã€Hedra) çš„é›†æˆã€‚
*   **æ¥è‡ª n8n çš„é”™è¯¯ä¼ æ’­:** å¦‚æœ n8n å·¥ä½œæµç¨‹å†…éƒ¨å¤±è´¥ï¼Œ`errorMessage` ä¼šä¼ é€’ç»™ webhookï¼Œä½†ç›®å‰æœªè¯¦ç»†å­˜å‚¨åœ¨ `projects` è¡¨ä¸­ (åªæœ‰çŠ¶æ€è®¾ç½®ä¸º 'failed')ã€‚

## ğŸ’¡æœªæ¥å¢å¼ºåŠŸèƒ½

*   **æ‰‹åŠ¨è°ƒæ•´ç§¯åˆ†:** ç®¡ç†å‘˜ç•Œé¢æˆ– Supabase å‡½æ•°ï¼Œç”¨äºä¸ºç‰¹å®šç”¨æˆ·æ·»åŠ /åˆ é™¤ç§¯åˆ†ã€‚
*   **è®¢é˜…è®¡åˆ’:** é›†æˆ Stripe æˆ–ç±»ä¼¼æœåŠ¡ï¼Œä¾›ç”¨æˆ·è´­ä¹°æ›´å¤šç§¯åˆ†æˆ–è®¢é˜…è®¡åˆ’ã€‚
*   **è¯¦ç»†çš„é¡¹ç›®é”™è¯¯æ—¥å¿—è®°å½•:** åœ¨ `projects` è¡¨ä¸­å­˜å‚¨æ¥è‡ª n8n çš„æ›´è¯¦ç»†çš„é”™è¯¯æ¶ˆæ¯ã€‚
*   **å¢å¼ºçš„è§†é¢‘æ’­æ”¾å™¨:** æ›´å¼ºå¤§çš„å¸¦æœ‰è‡ªå®šä¹‰æ§ä»¶çš„è§†é¢‘æ’­æ”¾å™¨ã€‚
*   **é€šçŸ¥:** è§†é¢‘ç”Ÿæˆå®Œæˆæˆ–å¤±è´¥æ—¶çš„ç”µå­é‚®ä»¶æˆ–åº”ç”¨å†…é€šçŸ¥ã€‚
*   **å…¬å¼€åˆ†äº«:** ç”¨æˆ·å¯ä»¥é€šè¿‡å…¬å¼€é“¾æ¥åˆ†äº«ä»–ä»¬ç”Ÿæˆçš„è§†é¢‘çš„é€‰é¡¹ã€‚
*   **i18n / æœ¬åœ°åŒ–:** UI çš„å®Œå…¨å›½é™…åŒ–ã€‚

---
(ä¹‹å‰ README ä¸­å…³äº X-Monitor çš„å†…å®¹å·²è¢«ç§»é™¤ï¼Œå› ä¸ºè¿™æ˜¯ä¸€ä¸ªæ–°çš„é¡¹ç›®é‡ç‚¹)
--- 